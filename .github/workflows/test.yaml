---
name: test
on: pull_request
jobs:
  plan:
    timeout-minutes: 15
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
    env:
      TFACTION_TARGET: terragrunt
      TFACTION_WORKING_DIR: terragrunt
      TFACTION_JOB_TYPE: terraform
    steps:
      - uses: actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683 # v4.2.2

      - uses: aquaproj/aqua-installer@f13c5d2f0357708d85477aabe50fd3f725528745 # v3.1.0
        with:
          aqua_version: v2.40.0
        env:
          AQUA_GITHUB_TOKEN: ${{github.token}}

      - name: Set up
        uses: suzuki-shunsuke/tfaction/setup@1eb11300c759d17050d0a81c3e8f1c6fa89b39d9 # v1.13.1
        with:
          github_token: ${{github.token}}

      - name: Plan
        uses: suzuki-shunsuke/tfaction/plan@1eb11300c759d17050d0a81c3e8f1c6fa89b39d9 # v1.13.1
        with:
          github_token: ${{github.token}}
        env:
          GITHUB_TOKEN: ${{github.token}} # For tfcmt and github-comment
